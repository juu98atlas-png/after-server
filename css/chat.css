const authPanel = document.getElementById("authPanel");
const dashboard = document.getElementById("dashboard");
const loginBtn = document.getElementById("loginBtn");
const registerBtn = document.getElementById("registerBtn");
const nicknameInput = document.getElementById("nicknameInput");
const passwordInput = document.getElementById("passwordInput");
const classSelect = document.getElementById("classSelect");
const authMessage = document.getElementById("authMessage");

let users = JSON.parse(localStorage.getItem("users") || "[]");
let currentUser = null;

registerBtn.addEventListener("click", () => {
  const nickname = nicknameInput.value.trim();
  const password = passwordInput.value;
  const userClass = classSelect.value;

  if (!nickname || !password) {
    authMessage.textContent = "Preencha todos os campos!";
    return;
  }

  if (users.find(u => u.nickname === nickname)) {
    authMessage.textContent = "Usu치rio j치 existe!";
    return;
  }

  const newUser = { nickname, password, class: userClass, level: 1, coins: 0, xp: 0 };
  users.push(newUser);
  localStorage.setItem("users", JSON.stringify(users));
  authMessage.textContent = "Cadastro realizado!";
});

loginBtn.addEventListener("click", () => {
  const nickname = nicknameInput.value.trim();
  const password = passwordInput.value;

  const user = users.find(u => u.nickname === nickname && u.password === password);
  if (!user) {
    authMessage.textContent = "Usu치rio ou senha inv치lidos!";
    return;
  }

  currentUser = user;
  authPanel.style.display = "none";
  dashboard.style.display = "block";
  updateDashboard();
});

function updateDashboard() {
  document.getElementById("level").textContent = currentUser.level;
  document.getElementById("coins").textContent = currentUser.coins;
}
